<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Employees | CourierOps</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body class="bg-[#F9F9F9] min-h-screen text-[#4B4B4D] font-sans">
  <header class="bg-[#4B4B4D] text-white p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold text-[#E32119]">CourierOps</h1>
    <a href="index.html" class="text-sm hover:underline">← Back to Dashboard</a>
  </header>

  <main class="p-6">
    <h2 class="text-2xl font-bold mb-4">Employees</h2>

    <div id="employeeTableContainer" class="bg-white rounded shadow p-4">
      <p id="loading" class="text-gray-500">Loading employees...</p>
      <table id="employeeTable" class="hidden w-full border-collapse">
        <thead>
          <tr class="bg-[#E32119] text-white">
            <th class="py-2 px-3 text-left">ID</th>
            <th class="py-2 px-3 text-left">Name</th>
            <th class="py-2 px-3 text-left">Role</th>
            <th class="py-2 px-3 text-left">Department</th>
          </tr>
        </thead>
        <tbody id="employeeBody"></tbody>
      </table>
    </div>
  </main>

  <script>
    const { createClient } = supabase;
    const supabaseUrl = 'https://mwtaveiqrinwdpjrjacz.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im13dGF2ZWlxcmlud2RwanJqYWN6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4MTkwNzYsImV4cCI6MjA3NTM5NTA3Nn0.2WU8_ukDX41eigfkcV7jwuVj1BSi-1FmFZIfyGiimdI';
    const client = createClient(supabaseUrl, supabaseKey);

    async function loadEmployees() {
      const { data, error } = await client.from('employees').select('*');
      const loadingText = document.getElementById('loading');
      const table = document.getElementById('employeeTable');
      const tbody = document.getElementById('employeeBody');

      if (error) {
        loadingText.textContent = 'Error loading employees.';
        console.error(error);
        return;
      }

      if (!data || data.length === 0) {
        loadingText.textContent = 'No employees found.';
        return;
      }

      loadingText.classList.add('hidden');
      table.classList.remove('hidden');

      data.forEach(emp => {
        const tr = document.createElement('tr');
        tr.className = "border-b hover:bg-gray-50";
        tr.innerHTML = `
          <td class="py-2 px-3">${emp.id}</td>
          <td class="py-2 px-3">${emp.name || '—'}</td>
          <td class="py-2 px-3">${emp.role || '—'}</td>
          <td class="py-2 px-3">${emp.department || '—'}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    loadEmployees();
  </script>
</body>
</html>
